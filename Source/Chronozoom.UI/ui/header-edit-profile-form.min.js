var __extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},CZ;(function(n){(function(t){var i=function(t){function i(n,i){t.call(this,n,i);this.saveButton=n.find(i.saveButton);this.logoutButton=n.find(i.logoutButton);this.usernameInput=n.find(i.usernameInput);this.emailInput=n.find(i.emailInput);this.agreeInput=n.find(i.agreeInput);this.loginPanel=$(document.body).find(i.loginPanel).first();this.profilePanel=$(document.body).find(i.profilePanel).first();this.loginPanelLogin=$(document.body).find(i.loginPanelLogin).first();this.allowRedirect=i.allowRedirect;this.usernameInput.off("keypress");this.emailInput.off("keypress");this.initialize()}return __extends(i,t),i.prototype.validEmail=function(n){if(String(n).length>254)return!1;return String(n).search(/^([\w^_]+((?:([-_.\+][\w^_]+)|))+|(xn--[\w^_]+))@([\w^_]+(?:(-+[\w^_]+)|)|(xn--[\w^_]+))(?:\.([\w^_]+(?:([\w-_\.\+][\w^_]+)|)|(xn--[\w^_]+)))$/i)!=-1},i.prototype.validUsername=function(n){return String(n).search(/^[a-z0-9\-_]{4,20}$/i)!=-1},i.prototype.initialize=function(){var t=this,r=n.Service.getProfile(),i;r.done(function(n){n.DisplayName!=null&&(t.usernameInput.val(n.DisplayName),n.DisplayName!=""&&t.usernameInput.prop("disabled",!0),t.emailInput.val(n.Email),n.Email!==undefined&&n.Email!==""&&n.Email!=null&&(t.agreeInput.attr("checked","true"),t.agreeInput.prop("disabled",!0)))});this.saveButton.click(function(){var f=t.validUsername(t.usernameInput.val()),i,r,u;if(!f){alert("Provided incorrect username, \n'a-z', '0-9', '-', '_' - characters allowed only. ");return}if(i="",t.emailInput.val()){if(r=t.validEmail(t.emailInput.val()),!r){alert("Provided incorrect email address");return}if(u=t.agreeInput.prop("checked"),!u){alert("Please agree with provided terms");return}i=t.emailInput.val()}n.Service.getProfile().done(function(r){n.Service.getProfile(t.usernameInput.val()).done(function(u){if(r.DisplayName==null&&typeof u.DisplayName!="undefined"){alert("Sorry, this username is already in use. Please try again.");return}n.Service.putProfile(t.usernameInput.val(),i).then(function(n){t.allowRedirect?window.location.assign("/"+n):t.close()},function(n){alert("Unable to save changes. Please try again later.");console.log(n)})})})});this.logoutButton.click(function(){WL.logout();window.location.assign("/pages/logoff.aspx")});i=function(n){n.which==13&&n.preventDefault()};this.usernameInput.keypress(i);this.emailInput.keypress(i)},i.prototype.show=function(){t.prototype.show.call(this,{effect:"slide",direction:"right",duration:500});this.activationSource.addClass("active")},i.prototype.close=function(){t.prototype.close.call(this,{effect:"slide",direction:"right",duration:500});this.activationSource.removeClass("active")},i}(n.UI.FormUpdateEntity);t.FormEditProfile=i})(n.UI||(n.UI={}));var t=n.UI})(CZ||(CZ={}));
/*
//# sourceMappingURL=header-edit-profile-form.min.js.map
*/