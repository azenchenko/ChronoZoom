var CZ;(function(n){(function(t){function r(n,t,i){this.Type="Pan";this.Source=i;this.xOffset=n;this.yOffset=t}function i(n,t,i,r){this.Type="Zoom";this.Source=r;this.xOrigin=n;this.yOrigin=t;this.scaleFactor=i}function u(n){this.Type="Pin";this.Source=n}function e(n){var i=$(document),u=n.toObservable("mousedown"),t=n.toObservable("mousemove"),f=i.toObservable("mouseup"),e=t.Skip(1).Zip(t,function(n,t){return new r(n.clientX-t.clientX,n.clientY-t.clientY,"Mouse")}),o=f;return u.SelectMany(function(){return e.TakeUntil(o)})}function o(n){var t=n.toObservable("mousedown");return t.Select(function(){return new u("Mouse")})}function f(t){t.mousewheel(function(i,r){var u=$.Event("xbrowserwheel");u.delta=r;u.origin=n.Common.getXBrowserMouseOrigin(t,i);t.trigger(u)});var r=t.toObservable("xbrowserwheel"),f=r.Zip(r,function(t){return new i(t.origin.x,t.origin.y,t.delta>0?1/n.Settings.zoomLevelFactor:1*n.Settings.zoomLevelFactor,"Mouse")}),u=t.toObservable("dblclick"),e=u.Zip(u,function(r){var u=n.Common.getXBrowserMouseOrigin(t,r);return new i(u.x,u.y,1/n.Settings.zoomLevelFactor,"Mouse")});return f}function s(n){var t=$(document),u=n.toObservable("touchstart"),i=n.toObservable("touchmove"),f=t.toObservable("touchend"),e=t.toObservable("touchcancel");return u.SelectMany(function(){return i.TakeUntil(f.Merge(e)).Skip(1).Zip(i,function(n,t){return{left:n.originalEvent,right:t.originalEvent}}).Where(function(n){return n.left.scale===n.right.scale}).Select(function(n){return new r(n.left.pageX-n.right.pageX,n.left.pageY-n.right.pageY,"Touch")})})}function h(n){var t=n.toObservable("touchstart");return t.Select(function(){return new u("Touch")})}function p(n){var t=$(document),u=n.toObservable("gesturestart"),r=n.toObservable("gesturechange"),f=t.toObservable("gestureend"),e=t.toObservable("touchcancel");return u.SelectMany(function(n){return r.TakeUntil(f.Merge(e)).Skip(1).Zip(r,function(n,t){return{left:n.originalEvent,right:t.originalEvent}}).Where(function(n){return n.left.scale!==n.right.scale&&n.right.scale!==0}).Select(function(t){var r=t.left.scale/t.right.scale;return new i(n.originalEvent.layerX,n.originalEvent.layerY,1/r,"Touch")})})}function c(n){var i=n.toObservable("MSGestureStart"),t=n.toObservable("MSGestureChange"),u=n.toObservable("MSGestureEnd");return i.SelectMany(function(){return t.TakeUntil(u).Skip(1).Zip(t,function(n,t){return{left:n.originalEvent,right:t.originalEvent}}).Where(function(n){return n.left.scale===n.right.scale&&n.left.detail!=n.left.MSGESTURE_FLAG_INERTIA&&n.right.detail!=n.right.MSGESTURE_FLAG_INERTIA}).Select(function(n){return new r(n.left.offsetX-n.right.offsetX,n.left.offsetY-n.right.offsetY,"Touch")})})}function l(n){var t=n.toObservable("MSPointerDown");return t.Select(function(){return new u("Touch")})}function a(n){var t=n.toObservable("MSGestureStart"),r=n.toObservable("MSGestureChange"),u=n.toObservable("MSGestureEnd");return t.SelectMany(function(n){return r.TakeUntil(u).Where(function(n){return n.originalEvent.scale!==0&&n.originalEvent.detail!=n.originalEvent.MSGESTURE_FLAG_INERTIA}).Select(function(t){return new i(n.originalEvent.offsetX,n.originalEvent.offsetY,1/t.originalEvent.scale,"Touch")})})}function y(n){v.forEach(function(t){t===n});v.push(n);n.addEventListener("MSPointerDown",function(t){if(n.gesture===undefined){var i=new MSGesture;i.target=n;n.gesture=i}n.gesture.addPointer(t.pointerId)},!1)}function w(n){var t,i,r,u,v;return window.navigator.msPointerEnabled&&window.MSGesture?(y(n[0]),t=c(n),u=a(n),v=f(n),i=u.Merge(v),r=l(n)):"ontouchstart"in document.documentElement?(t=s(n),i=p(n),r=h(n)):(t=e(n),i=f(n),r=o(n)),r.Merge(t.Merge(i))}function b(n){var t,i,r,u;return window.navigator.msPointerEnabled&&window.MSGesture?(y(n[0]),t=c(n),r=a(n),u=f(n),i=l(n)):"ontouchstart"in document.documentElement?(t=s(n),i=h(n)):(t=e(n),i=o(n)),i.Merge(t.Select(function(n){return n.yOffset=0,n}))}function k(n){return n.Where(function(n){return n.Type!="Zoom"}).Select(function(n){return n.Type=="Pan"&&(n.yOffset=0),n})}var v=[];t.getGesturesStream=w;t.getPanPinGesturesStream=b;t.applyAxisBehavior=k})(n.Gestures||(n.Gestures={}));var t=n.Gestures})(CZ||(CZ={}));
/*
//# sourceMappingURL=gestures.min.js.map
*/